var documenterSearchIndex = {"docs":
[{"location":"#NetCDFTools.jl","page":"Introduction","title":"NetCDFTools.jl","text":"","category":"section"},{"location":"","page":"Introduction","title":"Introduction","text":"Documentation for NetCDFTools.jl, a Julia package for loading/writing NetCDF data on  the top of NCDatasets.jl.","category":"page"},{"location":"#Installation","page":"Introduction","title":"Installation","text":"","category":"section"},{"location":"","page":"Introduction","title":"Introduction","text":"Inside the Julia shell, you can download and install using the following commands:","category":"page"},{"location":"","page":"Introduction","title":"Introduction","text":"using Pkg\nPkg.add(\"NetCDFTools\")","category":"page"},{"location":"","page":"Introduction","title":"Introduction","text":"nc_open\nnc_cellsize\n\nBase.getindex\n\nNetCDFTools.NcDim\nNetCDFTools.ncdim_def\nNetCDFTools.make_dims\n\nncvar_def\nncatt_put","category":"page"},{"location":"#NetCDFTools.nc_open","page":"Introduction","title":"NetCDFTools.nc_open","text":"open netcdf file, `nc_open` is alias of `NCDataset`\n\nnc_open(\n    f::Union{AbstractString, Vector{<:AbstractString}},\n    args...;\n    kwargs...\n) -> Any\n\n\nArguments\n\nmode:\n\"a\": append\n\"c\": create\n\nExamples\n\nnc_open(f, args; kwargs...)\n\ndefined at /home/runner/work/NetCDFTools.jl/NetCDFTools.jl/src/nc_info.jl:23.\n\n@seealso [NCDatasets.NCDataset()]\n\n\n\n\n\n","category":"function"},{"location":"#NetCDFTools.nc_cellsize","page":"Introduction","title":"NetCDFTools.nc_cellsize","text":"nc_cellsize(ds::NCdata)\n\n\n\n\n\n","category":"function"},{"location":"#Base.getindex","page":"Introduction","title":"Base.getindex","text":"getindex(\n    dims::Vector{NcDim},\n    name::Union{Regex, AbstractString}\n) -> Any\n\n\nExamples\n\nf = \"test/data/temp_HI.nc\"\ndims = nc_dims(f)\ndims[[\"lon\", \"lat\"]]\n\n\n\n\n\n","category":"function"},{"location":"#NetCDFTools.NcDim","page":"Introduction","title":"NetCDFTools.NcDim","text":"NcDim(name::AbstractString, vals::AbstractArray, atts::Dict = Dict())\n\nRepresents a NetCDF dimension of name name optionally holding the dimension values.\n\n\n\n\n\n","category":"type"},{"location":"#NetCDFTools.ncdim_def","page":"Introduction","title":"NetCDFTools.ncdim_def","text":"ncdim_def(ds, name, val, attrib = Dict())\nncdim_def(ds, dim::NcDim)\nncdim_def(ds, dims::Vector{NcDim})\n\nExamples\n\n## 1. by existing nc file\n# f = \"/mnt/j/Researches/Obs/Obs_ChinaHW_cluster/ncell_16/clusterId_HItasmax_movTRS_Obs.nc\"\ndims = nc_dims(f)\nds = nc_open(\"f2.nc\", \"c\")\nncdim_def(ds, dims);\nprintln(ds)\nclose(ds)\n\n## 2. by assigned variables\n# dates = nc_date(ds)\nds = nc_open(\"f3.nc\", \"c\")\ndim_t = NcDim_time(dates)\nncdim_def(ds, dim_t)\nclose(ds)\n\n\n\n\n\n","category":"function"},{"location":"#NetCDFTools.make_dims","page":"Introduction","title":"NetCDFTools.make_dims","text":"make_dims(range=[70, 140, 15, 55], cellsize = 0.5, dates)\n\nmake_dims(range, cellsize, dates)\n\ndefined at /home/runner/work/NetCDFTools.jl/NetCDFTools.jl/src/ncdim_def.jl:16.\n\n\n\n\n\n","category":"function"},{"location":"#NetCDFTools.ncvar_def","page":"Introduction","title":"NetCDFTools.ncvar_def","text":"ncvar_def(ds, name, val, dims::Vector{<:AbstractString}, attrib = Dict();\n    compress = 1, kwargs...)\nncvar_def(ds, name, val, dims::NcDim, attrib = Dict();\n    compress = 1, kwargs...)\n\nArguments\n\nval: can be data or vtype\ncompress: Compression level: 0 (default) means no compression and 9 means   maximum compression. Each chunk will be compressed individually.\ntype: which type to save? Julia variable types (not string), e.g., Float32.\noptions: Dictionary object, \nfillvalue: A value filled in the NetCDF file to indicate missing data.   It will be stored in the _FillValue attribute.\nchunksizes: Vector integers setting the chunk size. The total size of a   chunk must be less than 4 GiB. \nshuffle: If true, the shuffle filter is activated which can improve the   compression ratio.\nchecksum: The checksum method can be :fletcher32 or :nochecksum   (checksumming is disabled, which is the default)\nattrib: An iterable of attribute name and attribute value pairs, for   example a Dict, DataStructures.OrderedDict or simply a vector of pairs   (see example below)\n\nExamples\n\nf = \"f1.nc\"\nisfile(f) && rm(f)\nds = nc_open(f, \"c\")\ncompress = 1\n\nncdim_def(ds, \"lon\", lon, Dict(\"longname\" => \"Longitude\", \"units\" => \"degrees east\"))\nncdim_def(ds, \"lat\", lat, Dict(\"longname\" => \"Latitude\", \"units\" => \"degrees north\"))\nncdim_def(ds, \"time\", 1:ntime)\n\nncvar_def(ds, \"HI\", dat, [\"lon\", \"lat\", \"time\"], Dict(\"longname\" => \"hello\"); compress = compress)\nclose(ds)\n\n# append a variable\nds = nc_open(f, \"a\")\nncvar_def(ds, \"HI2\", dat, [\"lon\", \"lat\", \"time\"]; compress = compress)\nprint(ds)\nclose(ds)\n\nnc_info(f)\n\n@seealso ncdim_def\n\n\n\n\n\n","category":"function"},{"location":"#NetCDFTools.ncatt_put","page":"Introduction","title":"NetCDFTools.ncatt_put","text":"ncatt_get(f::NCfiles, key)\nncatt_put(f::AbstractString, attrib = Dict())\nncatt_del(f::AbstractString, keys::Vector{<:AbstractString})\n\nadd or delete global attributes\n\n\n\n\n\n","category":"function"},{"location":"","page":"Introduction","title":"Introduction","text":"nc_read\nnc_write\nnc_write!","category":"page"},{"location":"#NetCDFTools.nc_read","page":"Introduction","title":"NetCDFTools.nc_read","text":"nc_read(file) -> Any\nnc_read(\n    file,\n    band;\n    type,\n    period,\n    ind,\n    raw,\n    nodata,\n    verbose\n) -> Any\n\n\nArguments\n\nband  : string (variable name) or int (band id). If int provided,            bandName = nc_bands(file)[band]\ntype  : returned data type, e.g. Float32\nperiod: [year_start, year_end] or year, time should be in the 3rd dimension.\nind   : If ind provided, period will be ignored.\nraw   : Boolean. \ntrue: raw data.\nfalse (default): missing will be replaced with nodata\nverbose: Boolean. It true, data and ind will be printed on the console.\n\n\n\n\n\n","category":"function"},{"location":"#NetCDFTools.nc_write","page":"Introduction","title":"NetCDFTools.nc_write","text":"nc_write(\n    f::AbstractString,\n    varname::AbstractString,\n    val,\n    dims::Vector{NcDim}\n) -> Any\nnc_write(\n    f::AbstractString,\n    varname::AbstractString,\n    val,\n    dims::Vector{NcDim},\n    attrib::Dict;\n    compress,\n    overwrite,\n    mode,\n    global_attrib,\n    kw...\n) -> Any\n\n\nArguments\n\nattrib: An iterable of attribute name and attribute value pairs, for example a Dict, DataStructures.OrderedDict or simply a vector of pairs (see example below)\ntype: which type to save? Julia variable types.\nkwargs: Parameters passed to ncvar_def, and further to  [NCDatasets.defVar]. For examples:\nfillvalue: A value filled in the NetCDF file to indicate missing data. It  will be stored in the _FillValue attribute.\nchunksizes: Vector integers setting the chunk size. The total size of a  chunk must be less than 4 GiB.\nshuffle: If true, the shuffle filter is activated which can improve the  compression ratio.\nchecksum: The checksum method can be :fletcher32 or :nochecksum  (checksumming is disabled, which is the default)\nmode(not used): one of \"r\", \"c\", \"w\", see [NCDatasets.nc_open()] for details\n\nExamples:\n\ndims = [\n    NcDim(\"lon\", lon, Dict(\"longname\" => \"Longitude\", \"units\" => \"degrees east\"))\n    NcDim(\"lat\", lat, Dict(\"longname\" => \"Latitude\", \"units\" => \"degrees north\"))\n    NcDim_time(dates)\n]\ndims = make_dims(range, cellsize, dates) # another option\n\nnc_write(f, varname, val, dims)\n\nnc_write(f, varname, val, dims)\nnc_write(\n    f,\n    varname,\n    val,\n    dims,\n    attrib;\n    compress,\n    overwrite,\n    mode,\n    global_attrib,\n    kw...\n)\n\ndefined at /home/runner/work/NetCDFTools.jl/NetCDFTools.jl/src/nc_write.jl:45.\n\n@seealso ncvar_def\n\n\n\n\n\n","category":"function"},{"location":"#NetCDFTools.nc_write!","page":"Introduction","title":"NetCDFTools.nc_write!","text":"nc_write!(\n    f::AbstractString,\n    varname::AbstractString,\n    val,\n    dims::Vector{<:Union{AbstractString, NcDim}}\n) -> Any\nnc_write!(\n    f::AbstractString,\n    varname::AbstractString,\n    val,\n    dims::Vector{<:Union{AbstractString, NcDim}},\n    attrib::Dict;\n    compress,\n    kw...\n) -> Any\n\n\nnc_write!(f, varname, val, dims)\nnc_write!(f, varname, val, dims, attrib; compress, kw...)\n\ndefined at /home/runner/work/NetCDFTools.jl/NetCDFTools.jl/src/nc_write.jl:85.\n\n\n\n\n\nnc_write!(\n    val::AbstractArray,\n    f::AbstractString,\n    dims::Vector{<:Union{AbstractString, NcDim}}\n) -> Any\nnc_write!(\n    val::AbstractArray,\n    f::AbstractString,\n    dims::Vector{<:Union{AbstractString, NcDim}},\n    attrib;\n    varname,\n    kw...\n) -> Any\n\n\nnc_write!(val, f, dims)\nnc_write!(val, f, dims, attrib; varname, kw...)\n\ndefined at /home/runner/work/NetCDFTools.jl/NetCDFTools.jl/src/nc_write.jl:100.\n\n\n\n\n\n","category":"function"},{"location":"#Utilities","page":"Introduction","title":"Utilities","text":"","category":"section"},{"location":"","page":"Introduction","title":"Introduction","text":"QDM\nbilinear\n\nnc_aggregate\nnc_aggregate_dir\n\nnc_combine\nnc_subset","category":"page"},{"location":"#NetCDFTools.QDM","page":"Introduction","title":"NetCDFTools.QDM","text":"QDM(\n    y_obs::AbstractArray{T<:Real, 1},\n    y_calib::AbstractArray{T<:Real, 1},\n    y_pred::AbstractArray{T<:Real, 1};\n    type_adj,\n    kw...\n) -> Any\n\n\nArguments\n\ntype_adj: \nadd: 高斯分布的变量，如Tair\nmul: 降水\n\nNotes\n\nQDM: 需要使用一个滑动窗口。\n\nClimDown使用的是10年的窗口，一次处理10年；\nclimQMBC使用的是nobs的窗口，一次处理1年。\n\nReferences\n\nCannon, A. J., Sobie, S. R., & Murdock, T. Q. (2015). Bias Correction of GCM Precipitation by Quantile Mapping: How Well Do Methods Preserve Changes in Quantiles and Extremes? Journal of Climate, 28(17), 6938–6959. https://doi.org/10.1175/JCLI-D-14-00754.1\nhttps://github.com/pacificclimate/ClimDown/blob/master/R/QDM.R#L126\nhttps://github.com/rpkgs/climQMBC/blob/master/R/map_QDM.R#L43\n\n\n\n\n\n","category":"function"},{"location":"#NetCDFTools.bilinear","page":"Introduction","title":"NetCDFTools.bilinear","text":"bilinear(\n    x,\n    y,\n    z::AbstractArray{T<:Real, 3},\n    xx,\n    yy;\n    na_rm\n) -> Any\n\n\nSuppose that the location, (locx, locy) lies in between the first two grid points in both x an y. That is locx is between x1 and x2 and locy is between y1 and y2. Let ex= (l1-x1)/(x2-x1) ey= (l2-y1)/(y2-y1). The interpolant is\n\n( 1-ex)(1-ey)z11 + (1- ex)(ey)z12 + ( ex)(1-ey)z21 + ( ex)(ey)z22\n\nWhere the z's are the corresponding elements of the Z matrix.\n\nbilinear(x, y, z, xx, yy; na_rm)\n\ndefined at /home/runner/work/NetCDFTools.jl/NetCDFTools.jl/src/Interpolation/bilinear.jl:30.\n\nReferences\n\nhttps://github.com/cran/fields/blob/master/R/interp.surface.R\nhttps://en.wikipedia.org/wiki/Bilinear_interpolation\n\nExamples\n\nlon = 70:5:140\nlat = 15:5:55\n\nLon = 70:2.5:140\nLat = 15:2.5:55\nZ = rand(T, length(lon), length(lat), 2)\nr = bilinear(lon, lat, Z, Lon, Lat; na_rm=true)\n\n\n\n\n\n","category":"function"},{"location":"#NetCDFTools.nc_aggregate","page":"Introduction","title":"NetCDFTools.nc_aggregate","text":"nc_aggregate(\n    f::AbstractString\n) -> Union{Nothing, NCDatasets.NCDataset}\nnc_aggregate(\n    f::AbstractString,\n    fout;\n    by,\n    fun,\n    outdir,\n    overwrite,\n    verbose\n) -> Union{Nothing, NCDatasets.NCDataset}\n\n\nArguments\n\nf: input file\nfout: output file\nby: \"year\" or \"month\", or a function to group dates\n\nnc_aggregate(f)\nnc_aggregate(f, fout; by, fun, outdir, overwrite, verbose)\n\ndefined at /home/runner/work/NetCDFTools.jl/NetCDFTools.jl/src/utilize/nc_aggregate.jl:11.\n\n\n\n\n\n","category":"function"},{"location":"#NetCDFTools.nc_aggregate_dir","page":"Introduction","title":"NetCDFTools.nc_aggregate_dir","text":"nc_aggregate_dir(indir; by, replacement, outdir, kw...)\n\n\nExamples\n\nscenario = \"historical\"\nindir = \"Z:/ChinaHW/CMIP6_cluster_HItasmax_adjchunk/HI_tasmax/historical\"\noutdir = \"Z:/ChinaHW/CMIP6_cluster_HItasmax_adjchunk/HI_tasmax_year/historical\"\n\nnc_aggregate_dir(indir; by=\"year\", outdir)\n\nnc_aggregate_dir(indir; by, replacement, outdir, kw...)\n\ndefined at /home/runner/work/NetCDFTools.jl/NetCDFTools.jl/src/utilize/nc_aggregate.jl:66.\n\n\n\n\n\n","category":"function"},{"location":"#NetCDFTools.nc_combine","page":"Introduction","title":"NetCDFTools.nc_combine","text":"nc_combine(\n    d::DataFrames.AbstractDataFrame;\n    outdir,\n    overwrite,\n    kw...\n) -> Union{Nothing, NCDatasets.NCDataset{Nothing}}\n\n\nnc_combine(d; outdir, overwrite, kw...)\n\ndefined at /home/runner/work/NetCDFTools.jl/NetCDFTools.jl/src/utilize/nc_combine.jl:54.\n\n\n\n\n\n","category":"function"},{"location":"#NetCDFTools.nc_subset","page":"Introduction","title":"NetCDFTools.nc_subset","text":"nc_subset(\n    f,\n    range::Vector\n) -> Union{Nothing, NCDatasets.NCDataset{Nothing}}\nnc_subset(\n    f,\n    range::Vector,\n    fout;\n    delta,\n    check_vals,\n    verbose,\n    big,\n    plevs,\n    band,\n    outdir,\n    overwrite\n) -> Any\n\n\nArguments\n\ncheck_vals: If download failed, length(unique(vals)) = 1. Default check the length of data unique values\n\nNote\n\n! 目前只保存其中一个变量\n\nExample\n\n# 4-d array\nurl = \"http://esgf3.dkrz.de/thredds/dodsC/cmip6/CMIP/CSIRO-ARCCSS/ACCESS-CM2/historical/r1i1p1f1/day/zg/gn/v20191108/zg_day_ACCESS-CM2_historical_r1i1p1f1_gn_19500101-19541231.nc\"\n\nnc_open(url)\n\n# 3-d array\nurl = \"http://esgf-data04.diasjp.net/thredds/dodsC/esg_dataroot/CMIP6/CMIP/CSIRO-ARCCSS/ACCESS-CM2/historical/r1i1p1f1/day/huss/gn/v20191108/huss_day_ACCESS-CM2_historical_r1i1p1f1_gn_18500101-18991231.nc\"\n\nrange = [70, 140, 15, 55]\ndelta = 5\n\n@time nc_subset(url, range)\n\nnc_subset(f, range)\nnc_subset(\n    f,\n    range,\n    fout;\n    delta,\n    check_vals,\n    verbose,\n    big,\n    plevs,\n    band,\n    outdir,\n    overwrite\n)\n\ndefined at /home/runner/work/NetCDFTools.jl/NetCDFTools.jl/src/utilize/nc_subset.jl:32.\n\n\n\n\n\n","category":"function"},{"location":"#CMIP-functions","page":"Introduction","title":"CMIP functions","text":"","category":"section"},{"location":"","page":"Introduction","title":"Introduction","text":"CMIP.Tem_F2C\nCMIP.heat_index\n\nCMIP.get_model\nCMIP.CMIPFiles_info","category":"page"},{"location":"#NetCDFTools.CMIP.Tem_F2C","page":"Introduction","title":"NetCDFTools.CMIP.Tem_F2C","text":"Tem_F2C(T_degF::Real)\nTem_C2F(T_degC::Real)\n\n\n\n\n\n","category":"function"},{"location":"#NetCDFTools.CMIP.heat_index","page":"Introduction","title":"NetCDFTools.CMIP.heat_index","text":"heat_index(t::Union{<:Real,Missing}, rh::Union{<:Real,Missing})\nheat_index(t::AbstractArray{T}, rh::AbstractArray{T}) where {T<:Union{Missing,Real}}\nheat_index(f_tair::AbstractString, f_rh::AbstractString, outfile::AbstractString;\n    raw=true, offset = -273.15,\n    varname=\"HI\", type = Float32, compress=1, \n    overwrite=false)\n\nArguments\n\nt: degC\nrh: %\n\nExamples\n\nheat_index(f_tair, f_rh, outfile; overwrite = false, raw = true, compress = 1)\n\nReferences\n\nhttps://www.wpc.ncep.noaa.gov/html/heatindex_equationbody.html\nKong, D., Gu, X., Li, J., Ren, G., & Liu, J. (2020). Contributions of Global   Warming and Urbanization to the Intensification of Human‐Perceived Heatwaves   Over China. Journal of Geophysical Research: Atmospheres, 125(18), 1–16.   https://doi.org/10.1029/2019JD032175.\n\n\n\n\n\n","category":"function"},{"location":"#NetCDFTools.CMIP.get_model","page":"Introduction","title":"NetCDFTools.CMIP.get_model","text":"get_model(file; prefix = \"day_|mon_|year_\", postfix = \"_hist|_ssp|_piControl\")\n\n\n\n\n\n","category":"function"},{"location":"#NetCDFTools.CMIP.CMIPFiles_info","page":"Introduction","title":"NetCDFTools.CMIP.CMIPFiles_info","text":"CMIPFiles_info(\n    files;\n    detailed,\n    include_year,\n    include_nmiss\n) -> DataFrames.DataFrame\n\n\nNote: currently, only works for daily scale\n\nReturn\n\nmodel:\nensemble:\ndate_begin, date_end:\nfile:\n\nCMIPFiles_info(files; detailed, include_year, include_nmiss)\n\ndefined at /home/runner/work/NetCDFTools.jl/NetCDFTools.jl/src/CMIP/CMIPFiles_info.jl:82.\n\nExample\n\nfs = [\n  \"http://esgf-data04.diasjp.net/thredds/dodsC/esg_dataroot/CMIP6/CMIP/CSIRO-ARCCSS/ACCESS-CM2/historical/r1i1p1f1/day/huss/gn/v20191108/huss_day_ACCESS-CM2_historical_r1i1p1f1_gn_18500101-18991231.nc\",\n  \"http://esgf-data04.diasjp.net/thredds/dodsC/esg_dataroot/CMIP6/CMIP/CSIRO-ARCCSS/ACCESS-CM2/historical/r1i1p1f1/day/huss/gn/v20191108/huss_day_ACCESS-CM2_historical_r1i1p1f1_gn_19000101-19491231.nc\",\n  \"http://esgf-data04.diasjp.net/thredds/dodsC/esg_dataroot/CMIP6/CMIP/CSIRO-ARCCSS/ACCESS-CM2/historical/r1i1p1f1/day/huss/gn/v20191108/huss_day_ACCESS-CM2_historical_r1i1p1f1_gn_19500101-19991231.nc\",\n  \"http://esgf-data04.diasjp.net/thredds/dodsC/esg_dataroot/CMIP6/CMIP/CSIRO-ARCCSS/ACCESS-CM2/historical/r1i1p1f1/day/huss/gn/v20191108/huss_day_ACCESS-CM2_historical_r1i1p1f1_gn_20000101-20141231.nc\",\n  \"http://esgf-data04.diasjp.net/thredds/dodsC/esg_dataroot/CMIP6/ScenarioMIP/CSIRO-ARCCSS/ACCESS-CM2/ssp126/r1i1p1f1/day/huss/gn/v20210317/huss_day_ACCESS-CM2_ssp126_r1i1p1f1_gn_20150101-20641231.nc\",\n  \"http://esgf-data04.diasjp.net/thredds/dodsC/esg_dataroot/CMIP6/ScenarioMIP/CSIRO-ARCCSS/ACCESS-CM2/ssp126/r1i1p1f1/day/huss/gn/v20210317/huss_day_ACCESS-CM2_ssp126_r1i1p1f1_gn_20650101-21001231.nc\"\n]\ninfo = CMIP.CMIPFiles_info(fs; detailed=false)\n\n\n\n\n\n","category":"function"}]
}
